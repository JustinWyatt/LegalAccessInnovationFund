
@{
    ViewBag.Title = "CampaignBegin";
    Layout = "~/Views/Shared/_ApplicationLayout.cshtml";
}


<script src="//cdn.tinymce.com/4/tinymce.min.js"></script>
<script>
    tinymce.init(
            {
                selector: '.editable',
                height: 400,
                plugins: [
                  'advlist autolink lists link image charmap print preview anchor',
                  'searchreplace visualblocks code fullscreen',
                  'insertdatetime media table contextmenu paste code'
                ],
                toolbar: 'insertfile undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image',
                content_css: [
                  '//fast.fonts.net/cssapi/e6dc9b99-64fe-4292-ad98-6974f93cd2a2.css',
                  '//www.tinymce.com/css/codepen.min.css'
                ]
            }

    );

</script>

<script>
    tinymce.init({

        selector: '.donation',
        plugins: [
          'advlist autolink lists link image charmap print preview anchor',
          'searchreplace visualblocks code fullscreen',
          'insertdatetime media table contextmenu paste code'
        ],
        toolbar: 'insertfile undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image',
        content_css: [
          '//fast.fonts.net/cssapi/e6dc9b99-64fe-4292-ad98-6974f93cd2a2.css',
          '//www.tinymce.com/css/codepen.min.css'
        ]
    });

</script>

<style>
    .btn.outline {
        background: none;
        padding: 12px 22px;
    }

    .btn-primary.outline {
        border: 2px solid #0099cc;
        color: #0099cc;
    }

        .btn-primary.outline:hover, .btn-primary.outline:focus, .btn-primary.outline:active, .btn-primary.outline.active, .open > .dropdown-toggle.btn-primary {
            color: #33a6cc;
            border-color: #33a6cc;
        }

        .btn-primary.outline:active, .btn-primary.outline.active {
            border-color: #007299;
            color: #007299;
            box-shadow: none;
        }

    .donations {
        text-align: center;
        vertical-align: middle;
        border-radius: 6px;
        height: 75px;
        margin-bottom: 50px;
    }
</style>
<!-- Page content -->
<div ng-app="app" ng-controller="formController" ng-cloak>
    <form>
        <div class="span12">
            <div class="row">
                <div class="jumbotron text-center">
                    <h1>Start Your Campaign</h1>
                    <p>Here is where you will build your campaign. Put your story details and all other information here.</p>
                </div>

                <div class="row">
                    <div class="span12">
                        <br />
                        <br />
                        <br />

                        <h2 id="anch1">Write Your Story</h2>
                        <p>Give us a title of your story. We want it to be a summation of the topic of your story. Please keep it brief.</p>
                        <div class="row">
                            <fieldset>
                                <div class="span6">
                                    <label>Title</label>
                                    <input type="text" placeholder="Write the title of your story here." ng-model="campaign.Title" />
                                </div>
                                <div class="span6">
                                    <label>Goal</label>
                                    <input type="number" placeholder="What's your goal amount?" ng-model="campaign.Goal" />
                                </div>
                            </fieldset>
                        </div>
                        <p>Tell us your story in full detail. You may add pictures from the web. You may not upload pictures at this time. Be as detailed as possible when describing your story. We want to know the whole thing!</p>
                        <fieldset>
                            <textarea style="height:500px" ui-tinymce ng-model="rawStory">Enter the details of your story here.</textarea>

                        </fieldset>
                    </div>
                    <div class="span12">
                        <h3>Give Us A Picture</h3>
                        <br />
                        <p>Copy and paste a picture representing your story. The picture must be high definition and has quality. The picture can be of yourself or your organization</p>
                        <fieldset>
                            <input type="text" ng-model="campaign.Picture" />
                        </fieldset>

                        <img ng-src="{{campaign.Picture}}" style="height:250px" />
                    </div>
                    <div class="span12">
                        <div class="row">
                            <br />
                            <br />
                            <br />

                            <h3>Add Donation Levels<span></span></h3>

                            <br />
                            <p width="100%">Detail some donation levels for your cause. Whatever your cause, you can add perks for people at $25, $50, or $100 intervals. List your perks, the amount of contribution they represent and the quantity that are available. </p>
                        </div>
                        <div class="row">
                            <div class="span6">
                                <fieldset>
                                    <label>Title</label>

                                    <input type="text" ng-model="donationModel.Title" />

                                    <label>Description</label>

                                    <textarea ui-tinymce ng-model="donationModel.Description">Enter your donation details here.</textarea>
                                    <label>Quantity</label>
                                    <input type="number" ng-model="donationModel.Quantity" />

                                    <label>Add A Delivery Date</label>
                                    <input type="date" ng-model="donationModel.DeliveryDate" />

                                    <label>Donation Amount</label>
                                    <input type="text" ng-model="donationModel.Amount" />
                                    <br />
                                    <button class="fa fa-plus btn outline" ng-click="newDonationLevel(donationModel)">Add This Donation</button>

                                </fieldset>
                            </div>
                            <div class="span6">
                                <div class="row">
                                    <div class="span2" ng-repeat="donationLevel in campaign.DonationLevels">
                                        <div ng-model="donationLevel"  class="span2 donations">{{donationLevel.Title}}</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="span4"></div>
            <div class="span4">
                <fieldset>
                    <input ng-hide="confirmed" class="btn btn-primary outline span4" type="submit" ng-click="submitForm(campaign)" value="Submit This Campaign" />
                    <br />
                    <br />
                    <br />

                </fieldset>

                <div ng-show="confirmed">
                    <div class="alert alert-success">Your campaign has been uploaded. Click "Go To Your Campaign" to view your uploaded campaign. You may edit or delete a campaign.</div>
                    <a href="/campaign/campaignview/{{id}}" class="btn btn-success outline">Go To Your Campaign</a>
                </div>
            </div>
            <div class="span4"></div>
        </div>
    </form>
</div>

<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.0/angular.min.js"></script>
<script src="~/Scripts/tinymce.js"></script>

<script>

    var app = angular.module("app", ['ui.tinymce']);

    app.controller("formController", function ($sce, $scope, $http) {

        $scope.tinymceOptions = {
            onChange: function (e) {
                // put logic here for keypress and cut/paste changes
            },
            inline: false,
            plugins: 'advlist autolink link image lists charmap print preview',
            skin: 'lightgray',
            theme: 'advanced',
            height: 500
        };

        $scope.hide = true;
        $scope.confirmed = false;

        $scope.campaign = {

            Picture: '',
            Title: '',
            Goal: 0,
            Story: '',
            DonationLevels: [

                   {
                       Title: '',
                       Description: '',
                       Amount: 0,
                       Quantity: 0,
                       DeliveryDate: ''
                   }
            ]
        };

        $scope.newDonationLevel = function (donationModel) {

            $scope.donationModel.donationModelId = 0;

            if (donationModel != {}) {
                $scope.campaign.DonationLevels.push(donationModel);
                $scope.donationmodel.donationModelId + 1;
                $scope.donationModel = {};

            }

        }

            $scope.campaign.Story = $sce.trustAsHtml($scope.rawStory);

        $scope.campaign.Picture = "http://www.bestfact.net/wp-content/uploads/2014/05/Bestfact-JL-Carli-Conference-La-Defense-3112_original.jpg";

        $scope.submitForm = function (campaign) {
            $scope.confirmed = true;

            $http.post('/campaign/startcampaign', campaign).then(function (id) {
                $scope.campaign = {};
                $scope.id = id;
            });
        }
    });
</script>

